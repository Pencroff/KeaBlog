var wysibb=wysibb||{};
wysibb.render=function(a){a=a.replace(/</g,"&lt;");$.each(wysibb.options.smileList,function(b,c){a=a.replace(RegExp(wysibb.helpers.prepareRGX(c.bbcode),"g"),wysibb.helpers.strf(c.img,wysibb.options))});$.each(wysibb.options.allButtons,function(b,c){c.transform&&$.each(c.transform,function(b,c){for(var d,e,f=[],g={},h=function(a,b){g[b]=d[a+1]},b=b.replace(/\n/g,""),c=c.replace(/(\(|\)|\[|\]|\.|\*|\?|\:|\\|\\)/g,"\\$1").replace(" ","\\s+"),c=c.replace(/\{\S+?\}/gi,function(a){a=a.substr(1,a.length-
2);f.push(a);return"([\\s\\S]*?)"});null!==(d=RegExp(c,"mgi").exec(a));)d&&($.each(f,h),e=b,e=wysibb.helpers.strf(e,g),a=a.replace(d[0],e))})});$.each(wysibb.options.systr,function(b,c){c=c.replace(/(\(|\)|\[|\]|\.|\*|\?|\:|\\|\\)/g,"\\$1").replace(" ","\\s+");a=a.replace(RegExp(c,"g"),b)});if(hljs)for(var b,c,f,d=0;;){d=a.indexOf("<pre",d);if(-1===d)break;c=a.indexOf("/pre>",d);if(-1===c)break;else c+=5;b=a.substring(d,c);b=$(b)[0];b.parentNode.className||(b.parentNode.className="");hljs.highlightBlock(b,
null,!0);b=b.outerHTML;f=a.substring(0,d);c=a.substring(c);a=f+b+c;d+=b.length}return a};
wysibb.helpers={prepareRGX:function(a){return a.replace(/(\[|\]|\)|\(|\.|\*|\?|\:|\||\\)/g,"\\$1").replace(/\{.*?\}/g,"([\\s\\S]*?)")},strf:function(a,b){b=this.keysToLower($.extend({},b));return a.replace(/\{([\w\.]*)\}/g,function(a,f){var f=f.toLowerCase(),d=f.split("."),e=b[d.shift().toLowerCase()];$.each(d,function(){e=e[this]});return null===e||void 0===e?"":e})},keysToLower:function(a){$.each(a,function(b,c){b!==b.toLowerCase()&&(delete a[b],a[b.toLowerCase()]=c)});return a}};